<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Secure Checkout | Arrty Trails</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background-color: #050505; color: #e5e5e5; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        .glass-panel { background: rgba(20, 20, 20, 0.95); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.08); }
        .accent-text { color: #c89b3c; }
        .accent-bg { background-color: #c89b3c; }
        .method-card { transition: all 0.2s ease; border: 1px solid rgba(255,255,255,0.05); }
        .method-card:active { transform: scale(0.98); }
        .method-card:hover { border-color: #c89b3c; background: rgba(200, 155, 60, 0.05); }
        .custom-input { background: #111; border: 1px solid #333; color: white; transition: 0.3s; width: 100%; padding: 14px; border-radius: 8px; font-size: 15px; }
        .custom-input:focus { border-color: #c89b3c; outline: none; }
        .sig-wrapper { position: relative; width: 100%; height: 200px; background: white; border-radius: 12px; overflow: hidden; border: 2px solid #444; touch-action: none; }
        canvas#signature-pad { position: absolute; top: 0; left: 0; width: 100%; height: 100%; touch-action: none; }
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4 sm:p-6">

    <div class="w-full max-w-2xl text-center mb-6 pt-4">
        <h1 class="text-3xl font-bold text-white mb-2"><i class="fas fa-shield-alt accent-text mr-2"></i>Secure Payment</h1>
        <p class="text-gray-400 text-sm">Encrypted Transaction Gateway</p>
    </div>

    <div id="app-container" class="w-full max-w-2xl hidden fade-in">
        
        <div class="bg-gray-900/60 border border-gray-800 rounded-2xl p-5 mb-8 shadow-inner flex flex-col sm:flex-row justify-between items-center gap-4 text-center sm:text-left">
            <div>
                <p class="text-gray-500 text-xs uppercase font-bold tracking-wider mb-1">Order ID</p>
                <p class="text-lg font-mono text-white font-bold" id="display-order-id">...</p>
            </div>
            <div class="hidden sm:block w-px h-10 bg-gray-700"></div>
            <div>
                <p class="text-gray-500 text-xs uppercase font-bold tracking-wider mb-1">Customer</p>
                <p class="text-lg text-white font-medium" id="display-customer-name">...</p>
            </div>
            <div class="hidden sm:block w-px h-10 bg-gray-700"></div>
            <div>
                <p class="text-gray-500 text-xs uppercase font-bold tracking-wider mb-1">Transaction PID</p>
                <p class="text-lg font-mono text-yellow-500 font-bold" id="display-pid">...</p>
            </div>
        </div>

        <div id="view-methods" class="fade-in">
            <h3 class="text-white font-bold text-lg mb-4 ml-1">Select Payment Method</h3>
            <div id="methods-grid" class="grid sm:grid-cols-2 gap-4">
                <p class="text-center text-gray-500 py-8 animate-pulse col-span-2">Loading secure methods...</p>
            </div>
        </div>

        <div id="view-wizard" class="hidden fade-in">
            <div class="mb-8">
                <div class="flex justify-between text-[11px] uppercase font-bold text-gray-500 mb-3 tracking-wider px-2">
                    <span id="step-txt-1" class="text-yellow-500 transition-colors">1. Proof</span>
                    <span id="step-txt-2" class="transition-colors">2. Sender Info</span>
                    <span id="step-txt-3" class="transition-colors">3. Sign</span>
                </div>
                <div class="h-1.5 bg-gray-800 rounded-full overflow-hidden">
                    <div id="progress-bar" class="h-full bg-yellow-500 transition-all duration-500 w-1/3 shadow-[0_0_10px_rgba(234,179,8,0.5)]"></div>
                </div>
            </div>

            <div class="glass-panel rounded-2xl p-6 sm:p-8 shadow-2xl relative">
                <div id="step-1" class="step-content fade-in">
                    <h3 class="text-xl font-bold text-white mb-2">Upload Receipt</h3>
                    <p class="text-gray-400 text-sm mb-6">Upload a clear screenshot of your successful transaction.</p>
                    
                    <div id="drop-zone" class="border-2 border-dashed border-gray-600 rounded-xl p-8 text-center cursor-pointer hover:border-yellow-500 transition-colors bg-black/40 group">
                        <div id="upload-prompt">
                            <i class="fas fa-cloud-upload-alt text-4xl text-gray-500 mb-4 group-hover:text-yellow-500 transition-colors"></i>
                            <p class="text-sm text-gray-300 font-medium">Tap here to select screenshot</p>
                            <p class="text-xs text-gray-600 mt-2">JPG, PNG (Max 3MB)</p>
                        </div>
                        <div id="preview-container" class="hidden relative w-full flex justify-center">
                            <img id="image-preview" class="h-48 mx-auto rounded-lg object-contain shadow-lg border border-gray-700">
                            <button id="remove-image" class="absolute -top-3 -right-3 bg-red-600 text-white rounded-full w-8 h-8 flex items-center justify-center shadow-lg hover:bg-red-500 transition"><i class="fas fa-times"></i></button>
                        </div>
                    </div>
                    <input type="file" id="screenshot-input" accept="image/*" class="hidden">
                    
                    <button onclick="goToStep(2)" class="w-full mt-8 py-3.5 bg-white text-black font-bold rounded-xl hover:bg-gray-200 transition active:scale-95 text-lg">Next Step <i class="fas fa-arrow-right ml-2"></i></button>
                </div>

                <div id="step-2" class="step-content hidden fade-in">
                    <h3 class="text-xl font-bold text-white mb-2">Sender Details</h3>
                    <p class="text-gray-400 text-sm mb-6">Enter the details of the account that sent the payment.</p>
                    
                    <div class="space-y-5">
                        <div>
                            <label class="text-xs text-gray-400 uppercase font-bold tracking-wider ml-1">Account Title / Sender Name</label>
                            <input type="text" id="sender-name" class="custom-input mt-2" placeholder="e.g. Ali Khan">
                        </div>
                        <div>
                            <label class="text-xs text-gray-400 uppercase font-bold tracking-wider ml-1">Sender Phone Number</label>
                            <input type="tel" id="sender-phone" class="custom-input mt-2" placeholder="e.g. 0300 1234567">
                        </div>
                        
                        <div class="bg-yellow-900/20 border border-yellow-600/40 p-4 rounded-xl flex gap-4 mt-6">
                            <i class="fas fa-shield-alt text-yellow-500 text-xl flex-shrink-0 mt-0.5"></i>
                            <p class="text-sm text-yellow-100/90 leading-relaxed">
                                <strong class="text-yellow-400 block mb-1">Security Verification</strong>
                                You may receive a confirmation call from our team regarding this payment. Please ensure the number provided is active and matches the payment account.
                            </p>
                        </div>
                    </div>

                    <div class="flex gap-4 mt-8">
                        <button onclick="goToStep(1)" class="w-1/3 py-3.5 border border-gray-700 text-gray-300 font-medium rounded-xl hover:bg-gray-800 transition">Back</button>
                        <button onclick="goToStep(3)" class="w-2/3 py-3.5 bg-white text-black font-bold rounded-xl hover:bg-gray-200 transition active:scale-95 text-lg">Next <i class="fas fa-arrow-right ml-2"></i></button>
                    </div>
                </div>

                <div id="step-3" class="step-content hidden fade-in">
                    <h3 class="text-xl font-bold text-white mb-2">Digital Signature</h3>
                    <p class="text-gray-400 text-sm mb-6">Please provide your signature to authorize and complete this order.</p>
                    
                    <div class="sig-wrapper shadow-inner" id="sig-wrapper">
                        <canvas id="signature-pad"></canvas>
                        <div id="sig-placeholder" class="absolute inset-0 flex items-center justify-center pointer-events-none text-gray-500 font-medium bg-white/50">Draw Signature Here</div>
                        <button id="clear-sig" class="absolute bottom-3 right-3 text-xs bg-gray-800 text-white px-3 py-1.5 rounded-lg shadow-md hover:bg-gray-700 transition z-10">Clear</button>
                    </div>

                    <div class="flex gap-4 mt-8">
                        <button onclick="goToStep(2)" class="w-1/3 py-3.5 border border-gray-700 text-gray-300 font-medium rounded-xl hover:bg-gray-800 transition">Back</button>
                        <button id="submit-btn" class="w-2/3 py-3.5 bg-green-600 text-white font-bold rounded-xl shadow-[0_0_15px_rgba(22,163,74,0.4)] hover:bg-green-500 transition active:scale-95 text-lg">Submit <i class="fas fa-check-circle ml-2"></i></button>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div id="method-modal" class="fixed inset-0 bg-black/95 z-50 hidden flex items-center justify-center p-4 transition-opacity opacity-0">
        <div class="glass-panel w-full max-w-sm rounded-2xl p-6 sm:p-8 relative transform transition-transform scale-95" id="method-modal-content">
            <button onclick="closeMethodModal()" class="absolute top-4 right-4 text-gray-400 hover:text-white text-2xl w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-800 transition">&times;</button>
            
            <div class="text-center mb-8 mt-2">
                <div id="modal-logo-container" class="h-16 flex justify-center mb-4 drop-shadow-lg"></div>
                <h3 id="modal-title" class="text-2xl font-bold text-white mb-1"></h3>
                <p id="modal-owner" class="text-sm text-gray-400"></p>
            </div>

            <div class="bg-black/50 p-5 rounded-xl border border-gray-800 text-center mb-8 shadow-inner">
                <div id="modal-qr-area" class="hidden flex-col items-center justify-center">
                    <img id="modal-qr-img" class="w-48 h-48 rounded-xl border-4 border-white bg-white object-contain shadow-lg mb-3">
                    <p class="text-[10px] text-gray-500 uppercase font-bold tracking-widest">Scan to Pay</p>
                </div>
                <div id="modal-text-area" class="hidden flex-col items-center justify-center">
                    <p class="text-[10px] text-gray-500 uppercase font-bold mb-2 tracking-widest">Account Number / IBAN</p>
                    <div class="bg-gray-800 p-4 rounded-xl flex items-center justify-between cursor-pointer hover:bg-gray-700 active:bg-gray-600 transition w-full group" onclick="copyAccount()">
                        <span id="modal-account-text" class="font-mono text-green-400 font-bold text-lg tracking-wider w-full text-center"></span>
                        <i class="far fa-copy text-gray-400 group-hover:text-white transition-colors"></i>
                    </div>
                    <p class="text-[10px] text-gray-500 mt-3">Tap number to copy</p>
                </div>
            </div>

            <button onclick="startWizard()" class="w-full py-4 bg-white text-black font-bold rounded-xl text-lg hover:bg-gray-200 transition active:scale-95 shadow-lg">I Have Paid - Next Step</button>
        </div>
    </div>

    <div id="loading-overlay" class="fixed inset-0 bg-black/95 z-[100] hidden flex-col items-center justify-center backdrop-blur-sm">
        <div class="w-14 h-14 border-4 border-green-500 border-t-transparent rounded-full animate-spin mb-6 shadow-[0_0_15px_rgba(34,197,94,0.5)]"></div>
        <h2 class="text-2xl font-bold text-white mb-2">Securing Payment...</h2>
        <p class="text-gray-400 text-sm">Please do not close this window.</p>
    </div>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-appcheck.js"></script>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://wzdev.store/s0/pa03430.js"></script>
</body>

</html>

